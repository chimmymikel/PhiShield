{% extends 'phishield/base.html' %}
{% block title %}Analyze Message - PhiShield{% endblock %}

{% block content %}
<div class="content-card mt-4">
    <h3><i class="fas fa-envelope-open-text"></i> Analyze Suspicious Message</h3>
    <p class="text-muted">Paste a message or email content to check for phishing</p>

    <form method="post" class="mt-4">
        {% csrf_token %}
        {{ form.as_p }}
        <button type="submit" class="btn btn-warning btn-lg">
            <i class="fas fa-search"></i> Analyze Message
        </button>
    </form>

    {% if result %}
    <div class="mt-4 p-4 border rounded" style="background: #f8f9fa;">
        <h4>Analysis Result:</h4>
        <div class="mt-3">
            <span class="risk-badge risk-{{ result }} fs-5">
                {% if result == 'safe' %}
                    <i class="fas fa-check-circle"></i> SAFE
                {% elif result == 'suspicious' %}
                    <i class="fas fa-exclamation-triangle"></i> SUSPICIOUS
                {% elif result == 'dangerous' %}
                    <i class="fas fa-times-circle"></i> DANGEROUS
                {% endif %}
            </span>
        </div>
        
        {% if flags %}
        <div class="mt-3">
            <h6>Details:</h6>
            <p class="mb-0"><i class="fas fa-info-circle"></i> {{ flags }}</p>
        </div>
        {% endif %}
    </div>
    {% endif %}

    {% if tip %}
    <div class="alert alert-info mt-4">
        <i class="fas fa-lightbulb"></i> <strong>Tip:</strong> {{ tip }}
    </div>
    {% endif %}
</div>
{% endblock %}